<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é—®é—®å°çŒ« - ç¦»çº¿ç­”æ¡ˆä¹‹ä¹¦</title>
    <!-- å¼•å…¥SheetJSåº“ç”¨äºè§£æExcelæ–‡ä»¶ -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #000;
            color: #fff;
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: radial-gradient(circle at center, #1a1a1a, #000);
            transition: background 0.5s ease;
        }
        
        .step {
            max-width: 700px;
            width: 100%;
            text-align: center;
            padding: 40px 30px;
            border-radius: 20px;
            background: rgba(20, 20, 20, 0.9);
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.2);
            position: relative;
            overflow: hidden;
            display: none;
        }
        
        .step.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .step::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            border: 2px solid transparent;
            border-radius: 25px;
            background: linear-gradient(45deg, #d4af37, #f7ef8a, #d4af37);
            z-index: -1;
            animation: borderGlow 3s linear infinite;
        }
        
        @keyframes borderGlow {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: #d4af37;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
            letter-spacing: 2px;
        }
        
        h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #d4af37;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
        }
        
        .subtitle {
            color: #aaa;
            margin-bottom: 30px;
            font-size: 1rem;
            line-height: 1.5;
        }
        
        .cat-icon {
            width: 180px;
            height: 180px;
            margin: 30px auto;
            border-radius: 50%;
            overflow: hidden;
            border: 4px solid #d4af37;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
            animation: float 3s ease-in-out infinite;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(40, 40, 40, 0.7);
        }
        
        .cat-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }
        
        .file-upload {
            margin: 20px 0;
            padding: 20px;
            border: 2px dashed #d4af37;
            border-radius: 10px;
            background: rgba(40, 40, 40, 0.5);
        }
        
        .file-upload label {
            display: block;
            margin-bottom: 15px;
            color: #d4af37;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .file-input {
            width: 100%;
            padding: 12px;
            background: rgba(60, 60, 60, 0.7);
            border: 1px solid #d4af37;
            border-radius: 5px;
            color: white;
            margin-bottom: 15px;
        }
        
        .file-input:focus {
            outline: none;
            box-shadow: 0 0 5px rgba(212, 175, 55, 0.5);
        }
        
        .gold-button {
            background: linear-gradient(145deg, #d4af37, #f7ef8a);
            color: #000;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
            margin: 20px 0;
            letter-spacing: 1px;
            display: inline-block;
        }
        
        .gold-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.6);
        }
        
        .gold-button:active {
            transform: translateY(1px);
        }
        
        .gold-button:disabled {
            background: #666;
            cursor: not-allowed;
            box-shadow: none;
        }
        
        .answer-container {
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin: 30px 0;
            padding: 30px;
            border-radius: 15px;
            background: rgba(40, 40, 40, 0.7);
            border: 1px solid rgba(212, 175, 55, 0.3);
            transition: all 0.5s ease;
        }
        
        .answer-text {
            font-size: 1.6rem;
            line-height: 1.8;
            margin-bottom: 20px;
            font-style: italic;
            color: #f0f0f0;
            text-align: center;
        }
        
        .song-info {
            color: #d4af37;
            font-size: 1.2rem;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(212, 175, 55, 0.3);
            width: 100%;
            text-align: center;
        }
        
        .status-message {
            margin: 15px 0;
            padding: 12px;
            border-radius: 5px;
            font-size: 0.9rem;
            text-align: center;
        }
        
        .success {
            background: rgba(0, 128, 0, 0.2);
            color: #4CAF50;
            border: 1px solid #4CAF50;
        }
        
        .error {
            background: rgba(255, 0, 0, 0.2);
            color: #f44336;
            border: 1px solid #f44336;
        }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #444;
            margin: 0 8px;
            transition: all 0.3s ease;
        }
        
        .step-dot.active {
            background: #d4af37;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.7);
        }
        
        .footer {
            margin-top: 30px;
            color: #666;
            font-size: 0.9rem;
            text-align: center;
        }
        
        @media (max-width: 600px) {
            .step {
                padding: 30px 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.6rem;
            }
            
            .answer-text {
                font-size: 1.3rem;
            }
            
            .cat-icon {
                width: 140px;
                height: 140px;
            }
        }
    </style>
</head>
<body>
    <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
    <div class="step-indicator">
        <div class="step-dot" id="step1Dot"></div>
        <div class="step-dot" id="step2Dot"></div>
        <div class="step-dot" id="step3Dot"></div>
    </div>
    
    <!-- ç¬¬ä¸€æ­¥ï¼šä¸Šä¼ Excelæ–‡ä»¶ -->
    <div class="step active" id="step1">
        <p class="subtitle">è¯·ä¸Šä¼ æ–‡ä»¶ï¼Œæˆ‘ä»¬å°†ä»ä¸­éšæœºé€‰æ‹©ç­”æ¡ˆ</p>
        
        <div class="file-upload">
            <label for="excelFile">é€‰æ‹©Excelæ–‡ä»¶ (.xlsx æˆ– .xls)</label>
            <input type="file" id="excelFile" class="file-input" accept=".xlsx, .xls">
            <div id="fileStatus" class="status-message"></div>
        </div>
        
        <button class="gold-button" id="nextStep1" disabled>ä¸‹ä¸€æ­¥</button>
        
        <div class="footer">
            ç¡®ä¿Excelæ–‡ä»¶åŒ…å«"æ­Œè¯"ã€"å‰§ç›®"å’Œ"æ­Œå"åˆ—
        </div>
    </div>
    
    <!-- ç¬¬äºŒæ­¥ï¼šå°é¢é¡µé¢ -->
    <div class="step" id="step2">
        <h1>çŒ«çŸ¥é“ä¸€åˆ‡ç­”æ¡ˆ</h1>
        <div class="cat-icon">
            <img src="cat1.png" alt="å°çŒ«å¤´åƒ" id="catImage">
        </div>
        <p class="subtitle">å‡†å¤‡å¥½è·å–ç­”æ¡ˆäº†å—ï¼Ÿç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å‘å°çŒ«æé—®</p>
        
        <button class="gold-button" id="askButton">é—®é—®å°çŒ«</button>
        
        <div class="footer">
            ç‚¹å‡»æŒ‰é’®éšæœºè·å–ä¸€æ¡æ­Œè¯ä½œä¸ºç­”æ¡ˆ
        </div>
    </div>
    
    <!-- ç¬¬ä¸‰æ­¥ï¼šç­”æ¡ˆé¡µé¢ -->
    <div class="step" id="step3">
        <div class="cat-icon">
            <img src="cat2.png" alt="å°çŒ«å¤´åƒ" id="catImage2">
        </div>
        
        <div class="answer-container">
            <div class="answer-text" id="answerText">ç‚¹å‡»"é—®é—®å°çŒ«"æŒ‰é’®è·å–ç­”æ¡ˆ</div>
            <div class="song-info" id="songInfo"></div>
        </div>
        
        <button class="gold-button" id="askAgainButton">å†é—®ä¸€æ¬¡</button>
        
        <div class="footer">
            æ¯æ¬¡ç‚¹å‡»éƒ½ä¼šéšæœºé€‰æ‹©ä¸€æ¡æ–°çš„æ­Œè¯
        </div>
    </div>

    <script>
        // DOMå…ƒç´ 
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const step3 = document.getElementById('step3');
        const step1Dot = document.getElementById('step1Dot');
        const step2Dot = document.getElementById('step2Dot');
        const step3Dot = document.getElementById('step3Dot');
        
        const excelFileInput = document.getElementById('excelFile');
        const nextStep1Button = document.getElementById('nextStep1');
        const askButton = document.getElementById('askButton');
        const askAgainButton = document.getElementById('askAgainButton');
        const answerText = document.getElementById('answerText');
        const songInfo = document.getElementById('songInfo');
        const fileStatus = document.getElementById('fileStatus');
        const catImage = document.getElementById('catImage');
        const catImage2 = document.getElementById('catImage2');

        // å­˜å‚¨æ­Œè¯æ•°æ®
        let lyricsData = [];

        // æ­¥éª¤ç®¡ç†
        function goToStep(stepNumber) {
            // éšè—æ‰€æœ‰æ­¥éª¤
            step1.classList.remove('active');
            step2.classList.remove('active');
            step3.classList.remove('active');
            step1Dot.classList.remove('active');
            step2Dot.classList.remove('active');
            step3Dot.classList.remove('active');
            
            // æ˜¾ç¤ºæŒ‡å®šæ­¥éª¤
            if (stepNumber === 1) {
                step1.classList.add('active');
                step1Dot.classList.add('active');
            } else if (stepNumber === 2) {
                step2.classList.add('active');
                step2Dot.classList.add('active');
            } else if (stepNumber === 3) {
                step3.classList.add('active');
                step3Dot.classList.add('active');
            }
        }

        // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
        excelFileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            fileStatus.textContent = "æ­£åœ¨è¯»å–æ–‡ä»¶...";
            fileStatus.className = "status-message";
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // è·å–ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    
                    // å°†å·¥ä½œè¡¨è½¬æ¢ä¸ºJSON
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet);
                    
                    if (jsonData.length === 0) {
                        fileStatus.textContent = "Excelæ–‡ä»¶ä¸­æ²¡æœ‰æ•°æ®";
                        fileStatus.className = "status-message error";
                        nextStep1Button.disabled = true;
                        return;
                    }
                    
                    // æ£€æŸ¥å¿…è¦çš„åˆ—æ˜¯å¦å­˜åœ¨
                    const firstRow = jsonData[0];
                    const hasLyric = 'æ­Œè¯' in firstRow;
                    const hasSong = 'å‰§ç›®' in firstRow;
                    const hasArtist = 'æ­Œå' in firstRow;
                    
                    if (!hasLyric || !hasSong || !hasArtist) {
                        fileStatus.textContent = "Excelæ–‡ä»¶å¿…é¡»åŒ…å«'æ­Œè¯'ã€'å‰§ç›®'å’Œ'æ­Œå'åˆ—";
                        fileStatus.className = "status-message error";
                        nextStep1Button.disabled = true;
                        return;
                    }
                    
                    // å­˜å‚¨æ•°æ®
                    lyricsData = jsonData;
                    
                    fileStatus.textContent = `æˆåŠŸåŠ è½½ ${lyricsData.length} æ¡æ­Œè¯`;
                    fileStatus.className = "status-message success";
                    
                    // å¯ç”¨ä¸‹ä¸€æ­¥æŒ‰é’®
                    nextStep1Button.disabled = false;
                    
                } catch (error) {
                    console.error("è§£æExcelæ–‡ä»¶æ—¶å‡ºé”™:", error);
                    fileStatus.textContent = "æ— æ³•è§£æExcelæ–‡ä»¶ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ ¼å¼";
                    fileStatus.className = "status-message error";
                    nextStep1Button.disabled = true;
                }
            };
            
            reader.onerror = function() {
                fileStatus.textContent = "è¯»å–æ–‡ä»¶æ—¶å‡ºé”™";
                fileStatus.className = "status-message error";
                nextStep1Button.disabled = true;
            };
            
            reader.readAsArrayBuffer(file);
        });

        // éšæœºè·å–æ­Œè¯
        function getRandomLyric() {
            if (lyricsData.length === 0) return null;
            const randomIndex = Math.floor(Math.random() * lyricsData.length);
            return lyricsData[randomIndex];
        }

        // æ˜¾ç¤ºç­”æ¡ˆ
        function showAnswer() {
            const lyric = getRandomLyric();
            if (!lyric) {
                answerText.textContent = "æ²¡æœ‰å¯ç”¨çš„æ­Œè¯æ•°æ®";
                songInfo.textContent = "";
                return;
            }
            
            answerText.textContent = lyric.æ­Œè¯ || "æ— æ­Œè¯å†…å®¹";
            songInfo.textContent = `${lyric.å‰§ç›® || "æœªçŸ¥å‰§ç›®"} - ${lyric.æ­Œå || "æœªçŸ¥æ­Œå"}`;
        }

        // å¤„ç†å›¾ç‰‡åŠ è½½é”™è¯¯
        catImage.onerror = function() {
            console.error("æ— æ³•åŠ è½½å°çŒ«å›¾ç‰‡ï¼Œè¯·ç¡®ä¿cat.pngæ–‡ä»¶å­˜åœ¨");
            catImage.alt = "å°çŒ«å›¾ç‰‡åŠ è½½å¤±è´¥";
            catImage.style.display = 'none';
            // æ˜¾ç¤ºå¤‡ç”¨å›¾æ ‡
            const fallbackIcon = document.createElement('div');
            fallbackIcon.textContent = 'ğŸ±';
            fallbackIcon.style.fontSize = '5rem';
            catImage.parentNode.appendChild(fallbackIcon);
        };
        
        catImage2.onerror = function() {
            console.error("æ— æ³•åŠ è½½å°çŒ«å›¾ç‰‡ï¼Œè¯·ç¡®ä¿cat.pngæ–‡ä»¶å­˜åœ¨");
            catImage2.alt = "å°çŒ«å›¾ç‰‡åŠ è½½å¤±è´¥";
            catImage2.style.display = 'none';
            // æ˜¾ç¤ºå¤‡ç”¨å›¾æ ‡
            const fallbackIcon = document.createElement('div');
            fallbackIcon.textContent = 'ğŸ±';
            fallbackIcon.style.fontSize = '5rem';
            catImage2.parentNode.appendChild(fallbackIcon);
        };

        // äº‹ä»¶ç›‘å¬
        nextStep1Button.addEventListener('click', () => goToStep(2));
        askButton.addEventListener('click', () => {
            showAnswer();
            goToStep(3);
        });
        askAgainButton.addEventListener('click', () => goToStep(2));

        // åˆå§‹åŒ–
        window.addEventListener('load', () => {
            goToStep(1);
        });
    </script>
</body>
</html>